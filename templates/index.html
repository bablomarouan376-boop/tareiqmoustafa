<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecuCode Pro | طارق مصطفى</title>
    <link rel="manifest" href="/manifest.json">
    <style>
        :root { --primary: #3b82f6; --bg: #020617; --glass: rgba(30, 41, 59, 0.7); }
        * { box-sizing: border-box; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: var(--bg); color: white; margin: 0; min-height: 100vh;
            display: flex; align-items: center; justify-content: center;
            background-image: radial-gradient(circle at top, #1e40af 0%, #020617 80%);
        }
        .container { width: 90%; max-width: 750px; text-align: center; }
        .glass-card {
            background: var(--glass); backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1); border-radius: 2.5rem;
            padding: 3rem; box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }
        h1 { font-size: clamp(2.5rem, 8vw, 4.5rem); font-weight: 900; margin: 0; }
        .input-group {
            margin-top: 2.5rem; display: flex; background: rgba(0,0,0,0.4); 
            padding: 0.5rem; border-radius: 1.5rem; border: 1px solid rgba(255,255,255,0.1);
        }
        input {
            flex: 1; background: transparent; border: none; color: white;
            padding: 1rem; font-size: 1.1rem; outline: none;
        }
        button {
            background: var(--primary); color: white; border: none;
            padding: 1rem 2rem; border-radius: 1.2rem; font-weight: 900;
            cursor: pointer; box-shadow: 0 10px 20px rgba(59, 130, 246, 0.3);
        }
        button:hover { transform: translateY(-3px); background: #2563eb; }
        .results { 
            margin-top: 2.5rem; display: none; padding-top: 2rem; 
            border-top: 1px solid rgba(255,255,255,0.1); 
        }
        .score { font-size: 4rem; font-weight: 900; color: var(--primary); }
        footer { margin-top: 3rem; color: #475569; font-weight: bold; font-size: 0.8rem; letter-spacing: 2px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="glass-card">
            <div style="color:var(--primary); font-weight:bold; font-size:0.7rem; margin-bottom:1rem; letter-spacing:2px;">SECUCODE PRO V2.0</div>
            <h1>SecuCode Pro<span style="color:var(--primary)">.</span></h1>
            <p style="color:#94a3b8;">نظام الفحص الأمني الذكي لتحليل الروابط.</p>
            
            <div class="input-group">
                <input type="url" id="urlInput" placeholder="أدخل الرابط للفحص الفوري...">
                <button onclick="startScan()" id="btn">ابدأ الفحص</button>
            </div>

            <div id="resultArea" class="results">
                <div id="scoreNum" class="score">00</div>
                <h2 id="riskText" style="margin:0;">تحليل آمن</h2>
                <p id="analysisInfo" style="color:#94a3b8; font-size:0.9rem; margin-top:1rem;"></p>
            </div>
        </div>
        <footer>DESIGNED BY TAREK MOSTAFA</footer>
    </div>

    <script>
        async function startScan() {
            const val = document.getElementById('urlInput').value;
            const btn = document.getElementById('btn');
            if(!val) return alert("يرجى إدخال رابط");

            btn.innerText = "جاري الفحص...";
            btn.style.opacity = "0.5";
            
            try {
                const res = await fetch('/analyze', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({link: val})
                });
                const d = await res.json();
                
                document.getElementById('resultArea').style.display = "block";
                const scoreEl = document.getElementById('scoreNum');
                scoreEl.innerText = d.points;
                document.getElementById('riskText').innerText = d.risk_score;
                
                const isSafe = d.points < 25;
                scoreEl.style.color = isSafe ? "#22c55e" : "#ef4444";
                document.getElementById('riskText').style.color = isSafe ? "#22c55e" : "#ef4444";
                document.getElementById('analysisInfo').innerText = "تم إكمال التحليل في " + d.analysis_time + " ثانية.";
            } catch(e) { alert("خطأ في الاتصال بالسيرفر"); }
            
            btn.innerText = "ابدأ الفحص";
            btn.style.opacity = "1";
        }
    </script>
</body>
</html>
